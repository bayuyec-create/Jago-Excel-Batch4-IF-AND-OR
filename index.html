<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infografis Interaktif: Logika Excel IF, AND, & OR</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F9FA;
            color: #073B4C;
        }
        .excel-table-container {
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .formula-bar {
            background-color: #f3f4f6;
            padding: 0.5rem;
            border-bottom: 1px solid #d1d5db;
            font-family: monospace;
            color: #1f2937;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .name-box {
            background-color: white;
            border: 1px solid #d1d5db;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            text-align: center;
            min-width: 70px;
        }
        .fx-button {
            background-color: #e5e7eb;
            border: 1px solid #d1d5db;
            padding: 0.25rem 0.75rem;
            border-radius: 0.25rem;
            font-style: italic;
            cursor: default;
        }
        .formula-input {
            width: 100%;
            background: white;
            border: 1px solid #d1d5db;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            flex-grow: 1;
        }
        .formula-input:focus {
            outline: none;
            border-color: #118AB2;
            box-shadow: 0 0 0 2px rgba(17, 138, 178, 0.2);
        }
        .formula-input.invalid {
            border-color: #FF6B6B;
            color: #FF6B6B;
        }
        .excel-table {
            width: 100%;
            border-collapse: collapse;
        }
        .excel-table th, .excel-table td {
            border: 1px solid #e5e7eb;
            padding: 0.75rem;
            text-align: left;
            min-width: 80px;
        }
        .excel-table th {
            background-color: #f9fafb;
            font-weight: 600;
            text-align: center;
        }
        .excel-table .header-row-index {
            background-color: #f3f4f6;
            font-weight: 600;
            text-align: center;
        }
        .excel-table input[type="number"] {
            width: 100%;
            border: 2px solid transparent;
            border-radius: 0.25rem;
            padding: 0.5rem;
            text-align: center;
            transition: border-color 0.2s;
        }
        .excel-table input[type="number"]:focus {
            outline: none;
            border-color: #118AB2;
        }
        .result-cell {
            font-weight: 600;
            text-align: center;
            cursor: pointer;
        }
        .flowchart-node {
            border: 2px solid #118AB2;
            background-color: white;
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            min-width: 150px;
        }
        .flowchart-connector {
            display: flex;
            align-items: center;
            justify-content: center;
            color: #415A77;
            font-size: 2rem;
            margin: 0 1rem;
        }
        .formula-breakdown {
            background-color: #eef7ff;
            border: 1px solid #aed6f1;
            border-radius: 0.5rem;
            padding: 1rem;
            font-family: monospace;
            margin-bottom: 1.5rem;
        }
        .formula-breakdown .part {
            color: #118AB2;
            font-weight: bold;
        }
        .formula-breakdown .desc {
            color: #073B4C;
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">

        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-[#073B4C] mb-2">Bikin Excel Pintar ðŸ§ </h1>
            <p class="text-lg md:text-xl text-[#118AB2]">Kenalan Sama Jagoan Logika: IF + AND dan IF + OR</p>
        </header>

        <main class="space-y-16">
            
            <section id="if-intro" class="bg-white rounded-lg shadow-md p-6 md:p-8">
                <h2 class="text-3xl font-bold text-[#073B4C] mb-4 text-center">Si Jagoan Utama: Fungsi IF</h2>
                <p class="text-center text-lg max-w-3xl mx-auto mb-6">Fungsi IF adalah otak dari logika di Excel. Ia bekerja seperti sebuah perintah sederhana: "Jika sebuah syarat terpenuhi, lakukan ini. Jika tidak, lakukan itu."</p>
                <div class="bg-[#E0E1DD]/30 rounded-lg p-6 flex flex-col md:flex-row items-center justify-center gap-6 text-center">
                    <div class="bg-white p-4 rounded-lg shadow">
                        <p class="text-lg">Jika Nilai Siswa > 70...</p>
                    </div>
                    <div class="text-2xl font-bold text-[#118AB2]">âž”</div>
                    <div class="flex gap-4">
                        <div class="bg-[#06D6A0] text-white p-4 rounded-lg shadow-lg">
                            <p class="font-bold text-xl">"LULUS"</p>
                            <p class="text-sm">(Jika Benar)</p>
                        </div>
                        <div class="bg-[#FF6B6B] text-white p-4 rounded-lg shadow-lg">
                            <p class="font-bold text-xl">"GAGAL"</p>
                            <p class="text-sm">(Jika Salah)</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="if-and">
                <h2 class="text-3xl font-bold text-[#073B4C] mb-2 text-center">Duet Maut: IF + AND</h2>
                <p class="text-center text-lg max-w-3xl mx-auto mb-6">Kombinasi ini digunakan ketika ada beberapa syarat, dan **SEMUANYA** harus terpenuhi agar kondisi dianggap benar.</p>
                <div class="formula-breakdown">
                    <p class="font-bold mb-2">Struktur Rumus:</p>
                    <p><span class="part">=IF(AND(</span>syarat1; syarat2; ...<span class="part">);</span> "jika_benar"<span class="part">;</span> "jika_salah"<span class="part">)</span></p>
                    <ul class="list-disc list-inside mt-2 space-y-1 text-sm">
                        <li><span class="desc"><span class="part">AND(...)</span>: Kumpulkan semua syarat wajib di sini.</span></li>
                        <li><span class="desc"><span class="part">"jika_benar"</span>: Hasil jika semua syarat di dalam AND terpenuhi.</span></li>
                        <li><span class="desc"><span class="part">"jika_salah"</span>: Hasil jika ada satu saja syarat yang tidak terpenuhi.</span></li>
                    </ul>
                </div>
                <p class="text-center text-lg max-w-3xl mx-auto mb-6">Coba ubah nilai dan formula di bawah dan lihat hasilnya!</p>
                <div class="excel-table-container">
                    <div class="formula-bar">
                        <div class="name-box"><strong id="formula-cell-and">D2</strong></div>
                        <div class="fx-button"><em>fx</em></div>
                        <input type="text" class="formula-input" id="formula-input-and" value='=IF(AND(B2>80; C2>85); "Lulus Istimewa"; "Lulus Biasa")'>
                    </div>
                    <table class="excel-table" id="table-and">
                        <thead>
                            <tr><th class="header-row-index"></th><th>A</th><th>B</th><th>C</th><th>D</th></tr>
                            <tr><th class="header-row-index">1</th><th>Nama</th><th>Nilai Teori</th><th>Nilai Praktik</th><th>Status</th></tr>
                        </thead>
                        <tbody>
                            <tr data-row="2">
                                <td class="header-row-index">2</td><td tabindex="0">Budi</td>
                                <td><input type="number" value="90" min="0" max="100"></td>
                                <td><input type="number" value="95" min="0" max="100"></td>
                                <td class="result-cell" tabindex="0"></td>
                            </tr>
                            <tr data-row="3">
                                <td class="header-row-index">3</td><td tabindex="0">Ani</td>
                                <td><input type="number" value="75" min="0" max="100"></td>
                                <td><input type="number" value="90" min="0" max="100"></td>
                                <td class="result-cell" tabindex="0"></td>
                            </tr>
                            <tr data-row="4">
                                <td class="header-row-index">4</td><td tabindex="0">Candra</td>
                                <td><input type="number" value="92" min="0" max="100"></td>
                                <td><input type="number" value="80" min="0" max="100"></td>
                                <td class="result-cell" tabindex="0"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="if-or">
                <h2 class="text-3xl font-bold text-[#073B4C] mb-2 text-center">Si Fleksibel: IF + OR</h2>
                <p class="text-center text-lg max-w-3xl mx-auto mb-6">Gunakan kombinasi ini ketika ada beberapa syarat, dan **CUKUP SALAH SATU** saja yang terpenuhi untuk membuat kondisi dianggap benar.</p>
                <div class="formula-breakdown">
                    <p class="font-bold mb-2">Struktur Rumus:</p>
                    <p><span class="part">=IF(OR(</span>syarat1; syarat2; ...<span class="part">);</span> "jika_benar"<span class="part">;</span> "jika_salah"<span class="part">)</span></p>
                    <ul class="list-disc list-inside mt-2 space-y-1 text-sm">
                        <li><span class="desc"><span class="part">OR(...)</span>: Kumpulkan semua syarat pilihan di sini.</span></li>
                        <li><span class="desc"><span class="part">"jika_benar"</span>: Hasil jika minimal ada satu syarat yang terpenuhi.</span></li>
                        <li><span class="desc"><span class="part">"jika_salah"</span>: Hasil jika tidak ada satupun syarat yang terpenuhi.</span></li>
                    </ul>
                </div>
                <p class="text-center text-lg max-w-3xl mx-auto mb-6">Eksperimen dengan mengubah syaratnya!</p>
                 <div class="excel-table-container">
                    <div class="formula-bar">
                        <div class="name-box"><strong id="formula-cell-or">D2</strong></div>
                        <div class="fx-button"><em>fx</em></div>
                        <input type="text" class="formula-input" id="formula-input-or" value='=IF(OR(B2<60; C2<60); "Tugas Tambahan"; "Aman")'>
                    </div>
                    <table class="excel-table" id="table-or">
                        <thead>
                            <tr><th class="header-row-index"></th><th>A</th><th>B</th><th>C</th><th>D</th></tr>
                            <tr><th class="header-row-index">1</th><th>Nama</th><th>Nilai Teori</th><th>Nilai Praktik</th><th>Status</th></tr>
                        </thead>
                        <tbody>
                            <tr data-row="2">
                                <td class="header-row-index">2</td><td tabindex="0">Dodi</td>
                                <td><input type="number" value="55" min="0" max="100"></td>
                                <td><input type="number" value="80" min="0" max="100"></td>
                                <td class="result-cell" tabindex="0"></td>
                            </tr>
                            <tr data-row="3">
                                <td class="header-row-index">3</td><td tabindex="0">Eka</td>
                                <td><input type="number" value="90" min="0" max="100"></td>
                                <td><input type="number" value="50" min="0" max="100"></td>
                                <td class="result-cell" tabindex="0"></td>
                            </tr>
                            <tr data-row="4">
                                <td class="header-row-index">4</td><td tabindex="0">Fani</td>
                                <td><input type="number" value="70" min="0" max="100"></td>
                                <td><input type="number" value="75" min="0" max="100"></td>
                                <td class="result-cell" tabindex="0"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            
            <section id="flowchart" class="bg-white rounded-lg shadow-md p-6 md:p-8">
                <h2 class="text-3xl font-bold text-[#073B4C] mb-6 text-center">Kapan Pakai yang Mana?</h2>
                <p class="text-center text-lg max-w-3xl mx-auto mb-8">Masih bingung? Ikuti alur sederhana ini untuk memutuskan antara AND dan OR.</p>
                <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4">
                    <div class="flowchart-node"><p class="font-bold">Punya lebih dari satu syarat?</p></div>
                    <div class="flowchart-connector hidden md:block">â†’</div>
                    <div class="flowchart-connector md:hidden">â†“</div>
                    <div class="flex flex-col space-y-4">
                        <div class="flex items-center">
                            <div class="flowchart-node bg-[#118AB2]/10"><p class="font-bold">Apakah SEMUA harus terpenuhi?</p></div>
                            <div class="flowchart-connector">â†’</div>
                            <div class="flowchart-node bg-[#06D6A0]/80 text-white"><p class="font-bold">Gunakan AND</p></div>
                        </div>
                        <div class="flex items-center">
                            <div class="flowchart-node bg-[#118AB2]/10"><p class="font-bold">Apakah CUKUP SATU saja?</p></div>
                            <div class="flowchart-connector">â†’</div>
                            <div class="flowchart-node bg-[#FFD166]/80 text-[#073B4C]"><p class="font-bold">Gunakan OR</p></div>
                        </div>
                    </div>
                </div>
            </section>

        </main>

        <footer class="text-center mt-16 py-6 border-t border-gray-200">
            <p class="text-gray-600">Selamat mencoba! Kunci jago Excel adalah latihan. Teruslah bereksperimen!</p>
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            function parseFormula(formulaStr) {
                const mainRegex = /=IF\((AND|OR)\((.+)\)[;,]\s*"([^"]+)"[;,]\s*"([^"]+)"\)/i;
                const match = formulaStr.match(mainRegex);

                if (!match) return { isValid: false };

                const [_, logic, conditionsStr, trueVal, falseVal] = match;
                const conditionRegex = /([BC])\d+\s*([><=]=?)\s*(\d+(\.\d+)?)/g;
                
                const conditions = [];
                let condMatch;
                while ((condMatch = conditionRegex.exec(conditionsStr)) !== null) {
                    conditions.push({
                        cell: condMatch[1],
                        operator: condMatch[2],
                        value: parseFloat(condMatch[3])
                    });
                }
                
                if (conditions.length === 0) return { isValid: false };

                return {
                    isValid: true,
                    logic: logic.toUpperCase(),
                    conditions: conditions,
                    trueVal: trueVal,
                    falseVal: falseVal
                };
            }

            function evaluateCondition(val, operator, requiredVal) {
                switch (operator) {
                    case '>': return val > requiredVal;
                    case '<': return val < requiredVal;
                    case '>=': return val >= requiredVal;
                    case '<=': return val <= requiredVal;
                    case '=': return val == requiredVal;
                    default: return false;
                }
            }

            function applyFormula(parsedFormula, values) {
                let logicResult;
                const results = parsedFormula.conditions.map(cond => {
                    const cellValue = values[cond.cell];
                    return evaluateCondition(cellValue, cond.operator, cond.value);
                });

                if (parsedFormula.logic === 'AND') {
                    logicResult = results.every(res => res === true);
                } else { // OR
                    logicResult = results.some(res => res === true);
                }

                return logicResult ? parsedFormula.trueVal : parsedFormula.falseVal;
            }

            function updateTable(tableId, formulaInputId) {
                const formulaInput = document.getElementById(formulaInputId);
                const formulaStr = formulaInput.value;
                const parsedFormula = parseFormula(formulaStr);

                if (!parsedFormula.isValid) {
                    formulaInput.classList.add('invalid');
                    return;
                }
                formulaInput.classList.remove('invalid');

                const table = document.getElementById(tableId);
                const rows = table.querySelectorAll('tbody tr');

                rows.forEach(row => {
                    const inputs = row.querySelectorAll('input[type="number"]');
                    const values = {
                        B: parseFloat(inputs[0].value),
                        C: parseFloat(inputs[1].value)
                    };
                    
                    const resultText = applyFormula(parsedFormula, values);
                    const resultCell = row.querySelector('.result-cell');
                    resultCell.textContent = resultText;
                    resultCell.style.backgroundColor = '';
                    resultCell.style.color = '';
                });
            }

            function setupInteractiveTable(tableId, formulaInputId, cellDisplayId) {
                const table = document.getElementById(tableId);
                const formulaInput = document.getElementById(formulaInputId);
                const cellDisplay = document.getElementById(cellDisplayId);
                const columnLetters = ['A', 'B', 'C', 'D'];

                const updateAll = () => updateTable(tableId, formulaInputId);

                table.addEventListener('input', updateAll);
                formulaInput.addEventListener('input', updateAll);

                const allCells = table.querySelectorAll('tbody td[tabindex], tbody td input');
                allCells.forEach(el => {
                    el.addEventListener('focus', (e) => {
                        const cell = e.currentTarget.tagName === 'TD' ? e.currentTarget : e.currentTarget.parentElement;
                        const rowNum = cell.parentElement.dataset.row;
                        const colLetter = columnLetters[cell.cellIndex - 1];
                        if (colLetter) {
                            cellDisplay.textContent = `${colLetter}${rowNum}`;
                        }
                    });
                });

                updateAll();
            }

            setupInteractiveTable('table-and', 'formula-input-and', 'formula-cell-and');
            setupInteractiveTable('table-or', 'formula-input-or', 'formula-cell-or');
        });
    </script>
</body>
</html>
